<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë„¤ì´ë²„ ë™ì  ì§€ë„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <!-- ë„¤ì´ë²„ Maps API (Client ID ë°©ì‹) -->
  <script src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=s3f4t4mo6d"></script>
  <style>
    #map {
      width: 100%;
      height: 500px;
      margin-bottom: 10px:      
    }
    #info {
      font-family: monospace;
      background: #f7f7f7;
      padding: 10px;
      border: 1px solid #ccc; }
  </style>
</head>
<body>
 
  <h2>ğŸ“ ì„œìš¸ì‹œì²­ ì´ˆê¸° ë§ˆì»¤ + ì£¼ì†Œê²€ìƒ‰ + ë°˜ê²½ í‘œì‹œ</h2>

  <input type="text" id="searchInput" placeholder="ì£¼ì†Œ ì…ë ¥" style="width:300px;">
  <button onclick="searchAddress()">ğŸ” ê²€ìƒ‰</button>

  <div id="map"></div>
  <div id="info">ğŸ“Œ í´ë¦­ ìœ„ì¹˜ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>

  <script>
    const saved = [];
    let circle = null;

    // ì´ˆê¸° ì§€ë„ ìœ„ì¹˜: ì„œìš¸ì‹œì²­
    const seoulCityHall = new naver.maps.LatLng(37.5662952, 126.9779451);

    const map = new naver.maps.Map('map', {
      center: seoulCityHall,
      zoom: 13
    });

    // ì´ˆê¸° ë§ˆì»¤ (ì„œìš¸ì‹œì²­)
    new naver.maps.Marker({
      position: seoulCityHall,
      map: map,
      title: 'ì„œìš¸íŠ¹ë³„ì‹œì²­'
    });

    // ì§€ë„ í´ë¦­ ì‹œ ì´ë²¤íŠ¸
    naver.maps.Event.addListener(map, 'click', function (e) {
      const coord = e.coord;
      const lat = coord.lat();
      const lng = coord.lng();

      // ë§ˆì»¤
      new naver.maps.Marker({ position: coord, map: map });

      // ë°˜ê²½ ì›
      if (circle) circle.setMap(null);
      circle = new naver.maps.Circle({
        map: map,
        center: coord,
        radius: 500,
        strokeColor: '#007AFF',
        fillColor: '#CCE6FF',
        fillOpacity: 0.4
      });

      // ì£¼ì†Œ ì •ë³´
      naver.maps.Service.reverseGeocode({
        coords: coord,
        orders: naver.maps.Service.OrderType.ADDR
      }, function (status, response) {
        if (status !== naver.maps.Service.Status.OK) return alert('ì£¼ì†Œ ì¡°íšŒ ì‹¤íŒ¨');

        const result = response.v2.address;
        const address = result.jibunAddress || result.roadAddress || "ì£¼ì†Œ ì—†ìŒ";

        saved.push({ lat, lng, address });

        document.getElementById('info').innerHTML = `
          ğŸ§­ ìœ„ë„: ${lat.toFixed(6)}<br>
          ğŸ“ ê²½ë„: ${lng.toFixed(6)}<br>
          ğŸ  ì£¼ì†Œ: ${address}<br>
          ğŸ’¾ ì €ì¥ëœ ìœ„ì¹˜ ìˆ˜: ${saved.length}
        `;
        console.log(saved);
      });
    });

    // ì£¼ì†Œ ê²€ìƒ‰ ê¸°ëŠ¥
    function searchAddress() {
      const query = document.getElementById('searchInput').value;
      if (!query) return alert('ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”');

      naver.maps.Service.geocode({ query: query }, function (status, response) {
        if (status !== naver.maps.Service.Status.OK) return alert('ê²€ìƒ‰ ì‹¤íŒ¨');

        const item = response.v2.addresses[0];
        const latlng = new naver.maps.LatLng(item.y, item.x);

        map.setCenter(latlng);
        new naver.maps.Marker({ position: latlng, map: map });
      });
    }
  </script>
</body>
</html>  
  
  <style>#map{width:100%;height:500px;}</style>
</head>
<Body>
  <h3> ğŸ—ºï¸ ë„¤ì´ë²„ ì§€ë„ + ë§ˆì»¤ + í´ë¦­ </h3>
  <div id="map"></div></h3>
</Body>  
</head>
<body>
  <h2>ğŸ—ºï¸ ì§€ë„ í´ë¦­ â†’ ë§ˆì»¤ ìƒì„± + ì£¼ì†Œ ì €ì¥ + ë°˜ê²½ í‘œì‹œ</h2>
  <div id="map"></div>
  <div id="info">ğŸ“Œ í´ë¦­í•œ ìœ„ì¹˜ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>

  <script>
    window.onload = function () {
      const map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(37.5665, 126.9780),
        zoom: 13
      });

      const savedLocations = [];

      // í´ë¦­ ì´ë²¤íŠ¸
      naver.maps.Event.addListener(map, 'click', function (e) {
        const lat = e.coord.lat();
        const lng = e.coord.lng();

        const marker = new naver.maps.Marker({
          position: e.coord,
          map: map
        });

        const circle = new naver.maps.Circle({
          map: map,
          center: e.coord,
          radius: 500,
          strokeColor: '#007AFF',
          strokeOpacity: 0.7,
          strokeWeight: 2,
          fillColor: '#cce6ff',
          fillOpacity: 0.3
        });

        naver.maps.Service.reverseGeocode({
          coords: e.coord,
          orders: naver.maps.Service.OrderType.ADDR
        }, function (status, response) {
          if (status !== naver.maps.Service.Status.OK) {
            alert('ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
          }

          const result = response.v2.address;
          const address = result.jibunAddress || result.roadAddress || 'ì£¼ì†Œ ì—†ìŒ';

          savedLocations.push({
            lat: lat,
            lng: lng,
            address: address
          });

          document.getElementById('info').innerHTML = `
            ğŸ§­ ìœ„ë„: ${lat.toFixed(6)}<br>
            ğŸ“ ê²½ë„: ${lng.toFixed(6)}<br>
            ğŸ  ì£¼ì†Œ: ${address}<br>
            ğŸ’¾ ì €ì¥ëœ ì§€ì  ìˆ˜: ${savedLocations.length}
          `;
          console.log('ì €ì¥ëœ ìœ„ì¹˜ ëª©ë¡:', savedLocations);
        });
      });

      // ì§€ë„ ë¦¬í”„ë ˆì‹œ (ì§€ì—° í›„ ì‹¤í–‰)
      setTimeout(function () {
        map.refresh();
      }, 1000);
    };
  </script>
</body>
</html>
